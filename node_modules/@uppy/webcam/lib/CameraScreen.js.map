{"version":3,"names":["h","Component","SnapshotButton","RecordButton","RecordingLength","VideoSourceSelect","SubmitButton","DiscardButton","isModeAvailable","modes","mode","includes","CameraScreen","componentDidMount","onFocus","props","componentWillUnmount","onStop","render","src","recordedVideo","recording","supportsRecording","videoSources","showVideoSourceDropdown","showRecordingLength","onSubmit","i18n","mirror","onSnapshot","onStartRecording","onStopRecording","onDiscardRecordedVideo","recordingLengthSeconds","hasRecordedVideo","shouldShowRecordButton","shouldShowSnapshotButton","shouldShowRecordingLength","shouldShowVideoSourceDropdown","length","videoProps","playsinline","muted","controls","videoElement","srcObject","undefined","autoplay"],"sources":["CameraScreen.jsx"],"sourcesContent":["/* eslint-disable jsx-a11y/media-has-caption */\nimport { h, Component } from 'preact'\nimport SnapshotButton from './SnapshotButton.jsx'\nimport RecordButton from './RecordButton.jsx'\nimport RecordingLength from './RecordingLength.jsx'\nimport VideoSourceSelect from './VideoSourceSelect.jsx'\nimport SubmitButton from './SubmitButton.jsx'\nimport DiscardButton from './DiscardButton.jsx'\n\nfunction isModeAvailable (modes, mode) {\n  return modes.includes(mode)\n}\n\nclass CameraScreen extends Component {\n  componentDidMount () {\n    const { onFocus } = this.props\n    onFocus()\n  }\n\n  componentWillUnmount () {\n    const { onStop } = this.props\n    onStop()\n  }\n\n  render () {\n    const {\n      src,\n      recordedVideo,\n      recording,\n      modes,\n      supportsRecording,\n      videoSources,\n      showVideoSourceDropdown,\n      showRecordingLength,\n      onSubmit,\n      i18n,\n      mirror,\n      onSnapshot,\n      onStartRecording,\n      onStopRecording,\n      onDiscardRecordedVideo,\n      recordingLengthSeconds,\n    } = this.props\n\n    const hasRecordedVideo = !!recordedVideo\n    const shouldShowRecordButton = !hasRecordedVideo && supportsRecording && (\n      isModeAvailable(modes, 'video-only')\n      || isModeAvailable(modes, 'audio-only')\n      || isModeAvailable(modes, 'video-audio')\n    )\n    const shouldShowSnapshotButton = !hasRecordedVideo && isModeAvailable(modes, 'picture')\n    const shouldShowRecordingLength = supportsRecording && showRecordingLength && !hasRecordedVideo\n    const shouldShowVideoSourceDropdown = showVideoSourceDropdown && videoSources && videoSources.length > 1\n\n    const videoProps = {\n      playsinline: true,\n    }\n\n    if (recordedVideo) {\n      videoProps.muted = false\n      videoProps.controls = true\n      videoProps.src = recordedVideo\n\n      // reset srcObject in dom. If not resetted, stream sticks in element\n      if (this.videoElement) {\n        this.videoElement.srcObject = undefined\n      }\n    } else {\n      videoProps.muted = true\n      videoProps.autoplay = true\n      videoProps.srcObject = src\n    }\n\n    return (\n      <div className=\"uppy uppy-Webcam-container\">\n        <div className=\"uppy-Webcam-videoContainer\">\n          <video\n            /* eslint-disable-next-line no-return-assign */\n            ref={(videoElement) => (this.videoElement = videoElement)}\n            className={`uppy-Webcam-video  ${mirror ? 'uppy-Webcam-video--mirrored' : ''}`}\n            /* eslint-disable-next-line react/jsx-props-no-spreading */\n            {...videoProps}\n          />\n        </div>\n        <div className=\"uppy-Webcam-footer\">\n          <div className=\"uppy-Webcam-videoSourceContainer\">\n            {shouldShowVideoSourceDropdown\n              ? VideoSourceSelect(this.props)\n              : null}\n          </div>\n          <div className=\"uppy-Webcam-buttonContainer\">\n            {shouldShowSnapshotButton && <SnapshotButton onSnapshot={onSnapshot} i18n={i18n} />}\n\n            {shouldShowRecordButton && (\n              <RecordButton\n                recording={recording}\n                onStartRecording={onStartRecording}\n                onStopRecording={onStopRecording}\n                i18n={i18n}\n              />\n            )}\n\n            {hasRecordedVideo && <SubmitButton onSubmit={onSubmit} i18n={i18n} />}\n\n            {hasRecordedVideo && <DiscardButton onDiscard={onDiscardRecordedVideo} i18n={i18n} />}\n          </div>\n\n          <div className=\"uppy-Webcam-recordingLength\">\n            {shouldShowRecordingLength && (\n              <RecordingLength recordingLengthSeconds={recordingLengthSeconds} i18n={i18n} />\n            )}\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default CameraScreen\n"],"mappings":"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"}