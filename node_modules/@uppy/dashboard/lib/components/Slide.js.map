{"version":3,"names":["cloneElement","Component","toChildArray","classNames","transitionName","duration","Slide","constructor","props","state","cachedChildren","className","componentWillUpdate","nextProps","child","children","patch","cancelAnimationFrame","animationFrame","clearTimeout","leaveTimeout","undefined","requestAnimationFrame","setState","enterTimeout","setTimeout","render"],"sources":["Slide.jsx"],"sourcesContent":["import {  cloneElement, Component, toChildArray  } from 'preact'\nimport classNames from 'classnames'\n\nconst transitionName = 'uppy-transition-slideDownUp'\nconst duration = 250\n\n/**\n * Vertical slide transition.\n *\n * This can take a _single_ child component, which _must_ accept a `className` prop.\n *\n * Currently this is specific to the `uppy-transition-slideDownUp` transition,\n * but it should be simple to extend this for any type of single-element\n * transition by setting the CSS name and duration as props.\n */\nclass Slide extends Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      cachedChildren: null,\n      className: '',\n    }\n  }\n\n  // TODO: refactor to stable lifecycle method\n  // eslint-disable-next-line\n  componentWillUpdate (nextProps) {\n    const { cachedChildren } = this.state\n    const child = toChildArray(nextProps.children)[0]\n\n    if (cachedChildren === child) return null\n\n    const patch = {\n      cachedChildren: child,\n    }\n\n    // Enter transition\n    if (child && !cachedChildren) {\n      patch.className = `${transitionName}-enter`\n\n      cancelAnimationFrame(this.animationFrame)\n      clearTimeout(this.leaveTimeout)\n      this.leaveTimeout = undefined\n\n      this.animationFrame = requestAnimationFrame(() => {\n        // Force it to render before we add the active class\n        // this.base.getBoundingClientRect()\n\n        this.setState({\n          className: `${transitionName}-enter ${transitionName}-enter-active`,\n        })\n\n        this.enterTimeout = setTimeout(() => {\n          this.setState({ className: '' })\n        }, duration)\n      })\n    }\n\n    // Leave transition\n    if (cachedChildren && !child && this.leaveTimeout === undefined) {\n      patch.cachedChildren = cachedChildren\n      patch.className = `${transitionName}-leave`\n\n      cancelAnimationFrame(this.animationFrame)\n      clearTimeout(this.enterTimeout)\n      this.enterTimeout = undefined\n      this.animationFrame = requestAnimationFrame(() => {\n        this.setState({\n          className: `${transitionName}-leave ${transitionName}-leave-active`,\n        })\n\n        this.leaveTimeout = setTimeout(() => {\n          this.setState({\n            cachedChildren: null,\n            className: '',\n          })\n        }, duration)\n      })\n    }\n\n    // eslint-disable-next-line\n    this.setState(patch)\n  }\n\n  render () {\n    const { cachedChildren, className } = this.state\n\n    if (!cachedChildren) {\n      return null\n    }\n\n    return cloneElement(cachedChildren, {\n      className: classNames(className, cachedChildren.props.className),\n    })\n  }\n}\n\nexport default Slide\n"],"mappings":"AAAA,SAAUA,YAAV,EAAwBC,SAAxB,EAAmCC,YAAnC,QAAwD,QAAxD;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,MAAMC,cAAc,GAAG,6BAAvB;AACA,MAAMC,QAAQ,GAAG,GAAjB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,KAAN,SAAoBL,SAApB,CAA8B;EAC5BM,WAAW,CAAEC,KAAF,EAAS;IAClB,MAAMA,KAAN;IAEA,KAAKC,KAAL,GAAa;MACXC,cAAc,EAAE,IADL;MAEXC,SAAS,EAAE;IAFA,CAAb;EAID,CAR2B,CAU5B;EACA;;;EACAC,mBAAmB,CAAEC,SAAF,EAAa;IAC9B,MAAM;MAAEH;IAAF,IAAqB,KAAKD,KAAhC;IACA,MAAMK,KAAK,GAAGZ,YAAY,CAACW,SAAS,CAACE,QAAX,CAAZ,CAAiC,CAAjC,CAAd;IAEA,IAAIL,cAAc,KAAKI,KAAvB,EAA8B,OAAO,IAAP;IAE9B,MAAME,KAAK,GAAG;MACZN,cAAc,EAAEI;IADJ,CAAd,CAN8B,CAU9B;;IACA,IAAIA,KAAK,IAAI,CAACJ,cAAd,EAA8B;MAC5BM,KAAK,CAACL,SAAN,GAAmB,GAAEP,cAAe,QAApC;MAEAa,oBAAoB,CAAC,KAAKC,cAAN,CAApB;MACAC,YAAY,CAAC,KAAKC,YAAN,CAAZ;MACA,KAAKA,YAAL,GAAoBC,SAApB;MAEA,KAAKH,cAAL,GAAsBI,qBAAqB,CAAC,MAAM;QAChD;QACA;QAEA,KAAKC,QAAL,CAAc;UACZZ,SAAS,EAAG,GAAEP,cAAe,UAASA,cAAe;QADzC,CAAd;QAIA,KAAKoB,YAAL,GAAoBC,UAAU,CAAC,MAAM;UACnC,KAAKF,QAAL,CAAc;YAAEZ,SAAS,EAAE;UAAb,CAAd;QACD,CAF6B,EAE3BN,QAF2B,CAA9B;MAGD,CAX0C,CAA3C;IAYD,CA9B6B,CAgC9B;;;IACA,IAAIK,cAAc,IAAI,CAACI,KAAnB,IAA4B,KAAKM,YAAL,KAAsBC,SAAtD,EAAiE;MAC/DL,KAAK,CAACN,cAAN,GAAuBA,cAAvB;MACAM,KAAK,CAACL,SAAN,GAAmB,GAAEP,cAAe,QAApC;MAEAa,oBAAoB,CAAC,KAAKC,cAAN,CAApB;MACAC,YAAY,CAAC,KAAKK,YAAN,CAAZ;MACA,KAAKA,YAAL,GAAoBH,SAApB;MACA,KAAKH,cAAL,GAAsBI,qBAAqB,CAAC,MAAM;QAChD,KAAKC,QAAL,CAAc;UACZZ,SAAS,EAAG,GAAEP,cAAe,UAASA,cAAe;QADzC,CAAd;QAIA,KAAKgB,YAAL,GAAoBK,UAAU,CAAC,MAAM;UACnC,KAAKF,QAAL,CAAc;YACZb,cAAc,EAAE,IADJ;YAEZC,SAAS,EAAE;UAFC,CAAd;QAID,CAL6B,EAK3BN,QAL2B,CAA9B;MAMD,CAX0C,CAA3C;IAYD,CApD6B,CAsD9B;;;IACA,KAAKkB,QAAL,CAAcP,KAAd;EACD;;EAEDU,MAAM,GAAI;IACR,MAAM;MAAEhB,cAAF;MAAkBC;IAAlB,IAAgC,KAAKF,KAA3C;;IAEA,IAAI,CAACC,cAAL,EAAqB;MACnB,OAAO,IAAP;IACD;;IAED,OAAOV,YAAY,CAACU,cAAD,EAAiB;MAClCC,SAAS,EAAER,UAAU,CAACQ,SAAD,EAAYD,cAAc,CAACF,KAAf,CAAqBG,SAAjC;IADa,CAAjB,CAAnB;EAGD;;AAhF2B;;AAmF9B,eAAeL,KAAf"}