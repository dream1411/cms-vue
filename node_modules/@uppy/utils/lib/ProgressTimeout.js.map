{"version":3,"names":["ProgressTimeout","constructor","timeout","timeoutHandler","progress","clearTimeout","setTimeout","done"],"sources":["ProgressTimeout.js"],"sourcesContent":["/**\n * Helper to abort upload requests if there has not been any progress for `timeout` ms.\n * Create an instance using `timer = new ProgressTimeout(10000, onTimeout)`\n * Call `timer.progress()` to signal that there has been progress of any kind.\n * Call `timer.done()` when the upload has completed.\n */\nclass ProgressTimeout {\n  #aliveTimer\n\n  #isDone = false\n\n  #onTimedOut\n\n  #timeout\n\n  constructor (timeout, timeoutHandler) {\n    this.#timeout = timeout\n    this.#onTimedOut = timeoutHandler\n  }\n\n  progress () {\n    // Some browsers fire another progress event when the upload is\n    // cancelled, so we have to ignore progress after the timer was\n    // told to stop.\n    if (this.#isDone) return\n\n    if (this.#timeout > 0) {\n      clearTimeout(this.#aliveTimer)\n      this.#aliveTimer = setTimeout(this.#onTimedOut, this.#timeout)\n    }\n  }\n\n  done () {\n    if (!this.#isDone) {\n      clearTimeout(this.#aliveTimer)\n      this.#aliveTimer = null\n      this.#isDone = true\n    }\n  }\n}\n\nexport default ProgressTimeout\n"],"mappings":";;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMA,eAAN,CAAsB;EASpBC,WAAW,CAAEC,OAAF,EAAWC,cAAX,EAA2B;IAAA;MAAA;MAAA;IAAA;IAAA;MAAA;MAAA,OAN5B;IAM4B;IAAA;MAAA;MAAA;IAAA;IAAA;MAAA;MAAA;IAAA;IACpC,wDAAgBD,OAAhB;IACA,8DAAmBC,cAAnB;EACD;;EAEDC,QAAQ,GAAI;IACV;IACA;IACA;IACA,gCAAI,IAAJ,qBAAkB;;IAElB,IAAI,wDAAgB,CAApB,EAAuB;MACrBC,YAAY,6BAAC,IAAD,4BAAZ;MACA,8DAAmBC,UAAU,6BAAC,IAAD,yDAAmB,IAAnB,sBAA7B;IACD;EACF;;EAEDC,IAAI,GAAI;IACN,IAAI,6BAAC,IAAD,mBAAJ,EAAmB;MACjBF,YAAY,6BAAC,IAAD,4BAAZ;MACA,8DAAmB,IAAnB;MACA,sDAAe,IAAf;IACD;EACF;;AAhCmB;;AAmCtB,eAAeL,eAAf"}