{"version":3,"names":["h","classNames","statusBarStates","calculateProcessingProgress","UploadBtn","RetryBtn","CancelBtn","PauseResumeButton","DoneBtn","ProgressBarProcessing","ProgressBarError","ProgressBarUploading","ProgressBarComplete","STATE_ERROR","STATE_WAITING","STATE_PREPROCESSING","STATE_UPLOADING","STATE_POSTPROCESSING","STATE_COMPLETE","StatusBar","props","newFiles","allowNewUpload","isUploadInProgress","isAllPaused","resumableUploads","error","hideUploadButton","hidePauseResumeButton","hideCancelButton","hideRetryButton","recoveredState","uploadState","totalProgress","files","supportsUploadProgress","hideAfterFinish","isSomeGhost","doneButtonHandler","isUploadStarted","i18n","startUpload","uppy","isAllComplete","showProgressDetails","numUploads","complete","totalSize","totalETA","totalUploadedSize","getProgressValue","progress","mode","value","getIsIndeterminate","getIsHidden","progressValue","isHidden","width","showUploadBtn","showCancelBtn","showPauseResumeBtn","showRetryBtn","showDoneBtn","progressClassNames","statusBarClassNames"],"sources":["StatusBarUI.jsx"],"sourcesContent":["import { h } from 'preact'\nimport classNames from 'classnames'\nimport statusBarStates from './StatusBarStates.js'\nimport calculateProcessingProgress from './calculateProcessingProgress.js'\n\nimport {\n  UploadBtn,\n  RetryBtn,\n  CancelBtn,\n  PauseResumeButton,\n  DoneBtn,\n  ProgressBarProcessing,\n  ProgressBarError,\n  ProgressBarUploading,\n  ProgressBarComplete,\n} from './Components.jsx'\n\nconst {\n  STATE_ERROR,\n  STATE_WAITING,\n  STATE_PREPROCESSING,\n  STATE_UPLOADING,\n  STATE_POSTPROCESSING,\n  STATE_COMPLETE,\n} = statusBarStates\n\n// TODO: rename the function to StatusBarUI on the next major.\nexport default function StatusBar (props) {\n  const {\n    newFiles,\n    allowNewUpload,\n    isUploadInProgress,\n    isAllPaused,\n    resumableUploads,\n    error,\n    hideUploadButton,\n    hidePauseResumeButton,\n    hideCancelButton,\n    hideRetryButton,\n    recoveredState,\n    uploadState,\n    totalProgress,\n    files,\n    supportsUploadProgress,\n    hideAfterFinish,\n    isSomeGhost,\n    doneButtonHandler,\n    isUploadStarted,\n    i18n,\n    startUpload,\n    uppy,\n    isAllComplete,\n    showProgressDetails,\n    numUploads,\n    complete,\n    totalSize,\n    totalETA,\n    totalUploadedSize,\n  } = props\n\n  function getProgressValue () {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING: {\n        const progress = calculateProcessingProgress(files)\n\n        if (progress.mode === 'determinate') {\n          return progress.value * 100\n        }\n        return totalProgress\n      }\n      case STATE_ERROR: {\n        return null\n      }\n      case STATE_UPLOADING: {\n        if (!supportsUploadProgress) {\n          return null\n        }\n        return totalProgress\n      }\n      default:\n        return totalProgress\n    }\n  }\n\n  function getIsIndeterminate () {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING: {\n        const { mode } = calculateProcessingProgress(files)\n        return mode === 'indeterminate'\n      }\n      case STATE_UPLOADING: {\n        if (!supportsUploadProgress) {\n          return true\n        }\n        return false\n      }\n      default:\n        return false\n    }\n  }\n\n  function getIsHidden () {\n    if (recoveredState) {\n      return false\n    }\n\n    switch (uploadState) {\n      case STATE_WAITING:\n        return hideUploadButton || newFiles === 0\n      case STATE_COMPLETE:\n        return hideAfterFinish\n      default:\n        return false\n    }\n  }\n\n  const progressValue = getProgressValue()\n\n  const isHidden = getIsHidden()\n\n  const width = progressValue ?? 100\n\n  const showUploadBtn = !error\n    && newFiles\n    && !isUploadInProgress\n    && !isAllPaused\n    && allowNewUpload\n    && !hideUploadButton\n\n  const showCancelBtn = !hideCancelButton\n    && uploadState !== STATE_WAITING\n    && uploadState !== STATE_COMPLETE\n\n  const showPauseResumeBtn = resumableUploads\n    && !hidePauseResumeButton\n    && uploadState === STATE_UPLOADING\n\n  const showRetryBtn = error && !isAllComplete && !hideRetryButton\n\n  const showDoneBtn = doneButtonHandler && uploadState === STATE_COMPLETE\n\n  const progressClassNames = classNames('uppy-StatusBar-progress', {\n    'is-indeterminate': getIsIndeterminate(),\n  })\n\n  const statusBarClassNames = classNames(\n    'uppy-StatusBar',\n    `is-${uploadState}`,\n    { 'has-ghosts': isSomeGhost },\n  )\n\n  return (\n    <div className={statusBarClassNames} aria-hidden={isHidden}>\n      <div\n        className={progressClassNames}\n        style={{ width: `${width}%` }}\n        role=\"progressbar\"\n        aria-label={`${width}%`}\n        aria-valuetext={`${width}%`}\n        aria-valuemin=\"0\"\n        aria-valuemax=\"100\"\n        aria-valuenow={progressValue}\n      />\n\n      {(() => {\n        switch (uploadState) {\n          case STATE_PREPROCESSING:\n          case STATE_POSTPROCESSING:\n            return <ProgressBarProcessing progress={calculateProcessingProgress(files)} />\n          case STATE_COMPLETE:\n            return <ProgressBarComplete i18n={i18n} />\n          case STATE_ERROR:\n            return (\n              <ProgressBarError\n                error={error}\n                i18n={i18n}\n                numUploads={numUploads}\n                complete={complete}\n              />\n            )\n          case STATE_UPLOADING:\n            return (\n              <ProgressBarUploading\n                i18n={i18n}\n                supportsUploadProgress={supportsUploadProgress}\n                totalProgress={totalProgress}\n                showProgressDetails={showProgressDetails}\n                isUploadStarted={isUploadStarted}\n                isAllComplete={isAllComplete}\n                isAllPaused={isAllPaused}\n                newFiles={newFiles}\n                numUploads={numUploads}\n                complete={complete}\n                totalUploadedSize={totalUploadedSize}\n                totalSize={totalSize}\n                totalETA={totalETA}\n                startUpload={startUpload}\n              />\n            )\n          default:\n            return null\n        }\n      })()}\n\n      <div className=\"uppy-StatusBar-actions\">\n        {recoveredState || showUploadBtn ? (\n          <UploadBtn\n            newFiles={newFiles}\n            isUploadStarted={isUploadStarted}\n            recoveredState={recoveredState}\n            i18n={i18n}\n            isSomeGhost={isSomeGhost}\n            startUpload={startUpload}\n            uploadState={uploadState}\n          />\n        ) : null}\n\n        {showRetryBtn ? <RetryBtn i18n={i18n} uppy={uppy} /> : null}\n\n        {showPauseResumeBtn ? (\n          <PauseResumeButton\n            isAllPaused={isAllPaused}\n            i18n={i18n}\n            isAllComplete={isAllComplete}\n            resumableUploads={resumableUploads}\n            uppy={uppy}\n          />\n        ) : null}\n\n        {showCancelBtn ? <CancelBtn i18n={i18n} uppy={uppy} /> : null}\n\n        {showDoneBtn ? (\n          <DoneBtn i18n={i18n} doneButtonHandler={doneButtonHandler} />\n        ) : null}\n      </div>\n    </div>\n  )\n}\n"],"mappings":"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"}